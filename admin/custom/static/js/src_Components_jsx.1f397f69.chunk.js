"use strict";(self.webpackChunkiobroker_admin_component_backitup=self.webpackChunkiobroker_admin_component_backitup||[]).push([["src_Components_jsx"],{92452:(be,E,m)=>{m.r(E),m.d(E,{default:()=>ye});var G=m(28437),a=m.n(G),A=m(95973),o=m.n(A),g=m(70143),p=m(37449),d=m(67085),T=m(28437),R=Object.defineProperty,$=Object.defineProperties,M=Object.getOwnPropertyDescriptors,j=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable,b=(s,t,e)=>t in s?R(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,f=(s,t)=>{for(var e in t||(t={}))U.call(t,e)&&b(s,e,t[e]);if(j)for(var e of j(t))F.call(t,e)&&b(s,e,t[e]);return s},v=(s,t)=>$(s,M(t)),w=(s,t,e)=>(b(s,typeof t!="symbol"?t+"":t,e),e),C=(s,t,e)=>new Promise((i,c)=>{var n=r=>{try{l(e.next(r))}catch(h){c(h)}},u=r=>{try{l(e.throw(r))}catch(h){c(h)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(n,u);l((e=e.apply(s,t)).next())});class L extends p.ConfigGeneric{constructor(t){super(t),w(this,"fetchCcuConfig",()=>C(this,null,function*(){const e=Object.values(yield this.props.socket.getObjectViewCustom("system","instance","system.adapter.hm-rpc.","system.adapter.hm-rpc.\u9999"));let i=!1;if(e&&e.length){for(let c=0;c<e.length;c++)if(e[c].common.enabled){const u=e[c].native;this.props.onChange(v(f({},this.props.data),{ccuHost:u.homematicAddress,ccuUsehttps:u.useHttps})),this.props.onChange(v(f({},this.props.data),{ccuHost:u.homematicAddress,ccuUsehttps:u.useHttps})),i=e[c]._id;break}if(!i)for(let c=0;c<e.length;c++){const n=e[c].native;this.props.onChange(v(f({},this.props.data),{ccuHost:n.homematicAddress,ccuUsehttps:n.useHttps})),this.props.onChange(v(f({},this.props.data),{ccuHost:n.homematicAddress,ccuUsehttps:n.useHttps})),i=e[c]._id}}i?(i=i.substring(15),this.showMessage(p.I18n.t("Backitup Information!"),p.I18n.t("Config taken from %s",i))):this.showMessage(p.I18n.t("Backitup Warning!"),p.I18n.t("No config found"))})),w(this,"checkAdapterInstall",e=>C(this,null,function*(){const i=this.props.common.host,c=!1;let n=e;if((e==="pgsql"||e==="mysql"||e==="sqlite")&&(n="sql"),!c){const u=Object.values(yield this.props.socket.getObjectViewCustom("system","instance",`system.adapter.${n}.`,`system.adapter.${n}.\u9999`));if(u&&u.length){for(let l=0;l<u.length;l++)if(u[l].common.host!==i&&(n==="zigbee"||n==="esphome"||n==="zigbee2mqtt"||n==="node-red"||n==="yahka"||n==="jarvis"||n==="history")){this.showMessage(p.I18n.t("Backitup Warning!"),p.I18n.t("No %s Instance found on this host. Please check your System",n));break}}else u.length===0&&(n==="zigbee"||n==="esphome"||n==="zigbee2mqtt"||n==="node-red"||n==="yahka"||n==="jarvis"||n==="history")&&this.showMessage(p.I18n.t("Backitup Warning!"),p.I18n.t("No %s Instance found on this host. Please check your System",n))}})),w(this,"showMessage",(e,i)=>{this.setState({message:{title:e,text:i}})}),this.state.message=!1}renderMessage(){return this.state.message&&T.createElement(p.Message,{title:this.state.message.title,text:this.state.message.text,onClose:()=>this.setState({message:!1})})}}const D=L;var H=(s,t,e)=>new Promise((i,c)=>{var n=r=>{try{l(e.next(r))}catch(h){c(h)}},u=r=>{try{l(e.throw(r))}catch(h){c(h)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(n,u);l((e=e.apply(s,t)).next())});const W=()=>({});class x extends D{constructor(t){super(t),this.state.message=!1}renderItem(){return a().createElement(a().Fragment,null,a().createElement(d.FormControlLabel,{control:a().createElement(d.Checkbox,{onChange:()=>H(this,null,function*(){this.checkAdapterInstall("influxdb")})}),label:p.i18n.t("Adapter exist")}),this.renderMessage())}}x.propTypes={socket:o().object.isRequired,themeType:o().string,themeName:o().string,style:o().object,className:o().string,data:o().object.isRequired,attr:o().string,schema:o().object,onError:o().func,onChange:o().func};const z=(0,g.withStyles)(W)(x);var O=m(21839),V=Object.defineProperty,q=Object.defineProperties,X=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,P=(s,t,e)=>t in s?V(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,Q=(s,t)=>{for(var e in t||(t={}))J.call(t,e)&&P(s,e,t[e]);if(_)for(var e of _(t))K.call(t,e)&&P(s,e,t[e]);return s},Y=(s,t)=>q(s,X(t)),Z=(s,t,e)=>(P(s,typeof t!="symbol"?t+"":t,e),e),ee=(s,t,e)=>new Promise((i,c)=>{var n=r=>{try{l(e.next(r))}catch(h){c(h)}},u=r=>{try{l(e.throw(r))}catch(h){c(h)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(n,u);l((e=e.apply(s,t)).next())});const te=()=>({});class k extends p.ConfigGeneric{constructor(t){super(t),Z(this,"onOutput",(e,i)=>{i&&i.val&&i.val!==this.state.lastExecutionLine&&(this.setState({executionLog:`${this.state.executionLog+i.val}
`,lastExecutionLine:i.val}),i.val==="[EXIT] 0"&&(this.setState({executing:!1}),this.state.closeOnReady&&this.setState({executionDialog:!1})))}),this.state=Y(Q({},this.state),{executing:!1,executionDialog:!1,executionLog:"",lastExecutionLine:"",closeOnReady:!1})}componentDidMount(){super.componentDidMount(),this.props.socket.subscribeState(`${this.props.adapterName}.${this.props.instance}.output.line`,this.onOutput)}componentWillUnmount(){super.componentWillUnmount(),this.props.socket.unsubscribeState(`${this.props.adapterName}.${this.props.instance}.output.line`,this.onOutput)}renderExecutionDialog(){return a().createElement(d.Dialog,{open:this.state.executionDialog,onClose:()=>this.setState({executionDialog:!1}),maxWidth:"md",fullWidth:!0},a().createElement(d.DialogTitle,null,p.i18n.t("Backitup execution:")),a().createElement(d.DialogContent,null,a().createElement(d.TextField,{multiline:!0,fullWidth:!0,inputProps:{style:{height:400}},value:this.state.executionLog})),a().createElement(d.DialogActions,null,a().createElement(d.FormControlLabel,{control:a().createElement(d.Checkbox,{checked:this.state.closeOnReady,onChange:t=>this.setState({closeOnReady:t.target.checked})}),label:p.i18n.t("Close on ready")}),a().createElement(d.Button,{variant:"contained",onClick:()=>this.setState({executionDialog:!1})},p.i18n.t("Close"))))}renderItem(){return a().createElement(a().Fragment,null,a().createElement(d.Button,{onClick:()=>ee(this,null,function*(){this.setState({executionDialog:!0,executionLog:"",executing:!0}),yield this.props.socket.setState(`${this.props.adapterName}.${this.props.instance}.oneClick.ccu`,!0)}),variant:"contained",endIcon:a().createElement(O.CloudUpload,null)},p.i18n.t("Backup now")),this.renderExecutionDialog())}}k.propTypes={socket:o().object.isRequired,themeType:o().string,themeName:o().string,style:o().object,className:o().string,data:o().object.isRequired,attr:o().string,schema:o().object,onError:o().func,onChange:o().func};const se=(0,g.withStyles)(te)(k);var oe=(s,t,e)=>new Promise((i,c)=>{var n=r=>{try{l(e.next(r))}catch(h){c(h)}},u=r=>{try{l(e.throw(r))}catch(h){c(h)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(n,u);l((e=e.apply(s,t)).next())});const re=()=>({});class N extends D{renderItem(){return a().createElement(a().Fragment,null,a().createElement(d.Button,{variant:"contained",endIcon:a().createElement(O.Search,null),onClick:()=>oe(this,null,function*(){this.fetchCcuConfig()})},p.i18n.t("Detect config")),this.renderMessage())}}N.propTypes={socket:o().object.isRequired,themeType:o().string,themeName:o().string,style:o().object,className:o().string,data:o().object.isRequired,attr:o().string,schema:o().object,onError:o().func,onChange:o().func};const ne=(0,g.withStyles)(re)(N);var ae=Object.defineProperty,ie=Object.defineProperties,ce=Object.getOwnPropertyDescriptors,B=Object.getOwnPropertySymbols,le=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,he=Reflect.get,I=(s,t,e)=>t in s?ae(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,de=(s,t)=>{for(var e in t||(t={}))pe.call(t,e)&&I(s,e,t[e]);if(B)for(var e of B(t))ue.call(t,e)&&I(s,e,t[e]);return s},me=(s,t)=>ie(s,ce(t)),ge=(s,t,e)=>he(le(s),e,t),S=(s,t,e)=>new Promise((i,c)=>{var n=r=>{try{l(e.next(r))}catch(h){c(h)}},u=r=>{try{l(e.throw(r))}catch(h){c(h)}},l=r=>r.done?i(r.value):Promise.resolve(r.value).then(n,u);l((e=e.apply(s,t)).next())});const fe=()=>({});class y extends p.ConfigGeneric{constructor(t){super(t),this.state.googleDriveUrl=""}componentDidMount(){return S(this,null,function*(){ge(y.prototype,this,"componentDidMount").call(this);const t=yield this.props.socket.getObject(`system.adapter.${this.props.adapterName}.${this.props.instance}`);t&&t.native&&this.setState({native:t.native})})}renderItem(){return this.state.native?a().createElement("div",null,a().createElement("div",null,a().createElement(d.Button,{endIcon:a().createElement(O.CloudUpload,null),variant:"contained",onClick:()=>S(this,null,function*(){const t=yield this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,"authGoogleDrive");this.setState({googleDriveUrl:t.url})})},p.i18n.t(this.state.native.googledriveAccessTokens?"Renew google drive access":"Get google drive access"))),this.state.googleDriveUrl?a().createElement(a().Fragment,null,a().createElement("div",null,`${p.i18n.t("Authorize this app by visiting this url")}: `,a().createElement("a",{target:"_blank",href:this.state.googleDriveUrl,rel:"noreferrer"},this.state.googleDriveUrl)),a().createElement("div",null,a().createElement(d.TextField,{label:p.i18n.t("Enter the code from that page here"),variant:"standard",value:this.props.data.googledriveAccessTokens||"",onChange:t=>this.props.onChange(me(de({},this.props.data),{googledriveAccessTokens:t.target.value})),fullWidth:!0}))):null):null}}y.propTypes={socket:o().object.isRequired,themeType:o().string,themeName:o().string,style:o().object,className:o().string,data:o().object.isRequired,attr:o().string,schema:o().object,onError:o().func,onChange:o().func};const ve=(0,g.withStyles)(fe)(y),ye={AdapterExist:z,BackupNow:se,DetectConfig:ne,GoogleDrive:ve}}}]);

//# sourceMappingURL=src_Components_jsx.1f397f69.chunk.js.map